# Mass Shootings Tracker

The Mass Shootings Tracker is a Dashboard of mass shootings incidents occurred in the United States.
The application was developed using Python 3 and Dash, with dynamic charts generated by Plotly.

The user can view the shooting incidents in the interactive map, or in graphs displaying incidents by day, by month, or by state.


![Responsive Mockup](https://alexandrearantes1.github.io/mass-shootings/assets/images/map.png)

## Project Goals

The goal of this project is to deliver an application capable of manipulating a dataset and extract information and to provide insights about the information contained in the data. 

## Target Audience

This web app is targeted to anyone interested in tracking, or studying the phenomenon of mass shootings occurred in the US.

## Features

The Mass Shooting Tracker is divided into 3 sections:
1. The header containing the title and the navigation links:
   - Locations
   - By Day
   - By Month
   - By State.
2. The main content area where the graphs are displayed. 
3. A Footer with a link to the dash / plotly website.

### Existing Features

- __The Header__ 
  - The Header contains a title and the Navbar with the links for each tab of the dashboard. 
 
![Header](https://alexandrearantes1.github.io/mass-shootings/assets/images/header.png)

- __Locations Tab__
  - The locations tab contains an interactive map of the locations of each mass shooting incident. 
    - The user can hover over each dot to display more information about the incident such as location name, number of fatal victims and number of total victims.

![Locations](https://alexandrearantes1.github.io/mass-shootings/assets/images/locations.png)


- __By Day Tab__
  - This tab displays a scatter plot of the number of the shootings incidents vs day.
  - Most of the datapoints are at the base of the plot (as in 1 shooting per day), however, in some cases we can see as much as 7 mass shootings in a single day.

![By Day](https://alexandrearantes1.github.io/mass-shootings/assets/images/day.png)

- __By Month Tab__
  - This tab displays a bar plot of shootings by month of occurrence.
  - From this plot we can see that June, July and August are the months with highest number of incidents. This is supporting evidence to a theory that hot weather is linked to increase in violent behaviour.

![By Month](https://alexandrearantes1.github.io/mass-shootings/assets/images/month.png)

- __By State Tab__
  - This tab displays a horiozontal bar plot of shootings divided by state.
  - As it would be expected, the number of mass shooting incidents are strongly correlated with the state population.

![By State](https://alexandrearantes1.github.io/mass-shootings/assets/images/state.png)

- __List Tab__
  - This tab is divided into 2 sections:
    - A form to input new mass shooting incidents.
    - A list of the mass shooting incidents currently in the dataset.
  
    __The Form__
    - The user input is validated before being recorded into the dataset.
        - All fields are required.
        - Date must be between 01/01/1900 and the current date. 
        - The address is used to fetch latitude and longitude using Nominatim tool from Geopy library in order to plot the incident on the map.
        - Number of injured and killed must be non-negative integers.

    ![Form](https://alexandrearantes1.github.io/mass-shootings/assets/images/form.png)

    __The List__
    - The list is sorted in descending order by date, meaning the first item on the list is the most recent incident. 
    - Each row contains a button to delete the row, if necessary. 

    ![Form](https://alexandrearantes1.github.io/mass-shootings/assets/images/list.png)


- __The Footer__
  - The footer only contains a link to the dash / plotly website.

![Form](https://alexandrearantes1.github.io/mass-shootings/assets/images/footer.png)


### Features Left to Implement
- A password protected admin area so only authenticated users can insert or delete records.
- An edit page in order to change row contents. 
- An improved user interface with more attractive design would be very beneficial to the user experience. 

## Technologies

- Python 3
  - [Plotly](https://plotly.com/) for interactive map and charts. 
  - [Dash](https://dash.plotly.com/) for generating the Flask web application.
  - [Dash Bootstrap Components](https://dash-bootstrap-components.opensource.faculty.ai/) for UI elements. 
  - [Bootstrap](https://getbootstrap.com/) for styling and formatting the application. 
  - [Pandas](https://pandas.pydata.org/) for importing, exporting and manipulating the dataset.

- IDE - Visual Studio Code
  - The app was developed using the latest version of Visual Studio Code (1.70.2).
- Git 
  - Used to backup and document the development process.
- GitHub
  - The source code is hosted on GitHub and deployed using Heroku.

## Testing

The app was tested both on Google Chrome and Safari. 


### Functional Testing

_Scenario 1 - Correct input_
  1. Navigate to [Mass Shootings US](https://mass-shootings-us.herokuapp.com/).
  2. Click on the "List" tab:
  3. Select a date from the date picker.
  4. Enter the following information on the form:
     -Address: Madison Square Garden
     -Injured: 5
     -Killed: 3
  5. Click the button to save.
  
Expected:
1. The incident should be recorded on the dataset, the list of incidents below should be upodated to reflect the changes. 

Actual: the app behaves as expected. The incident is recorded on the dataset and the table containing the incident list is updated automatically. 

A new shooting incident does not appear immediately on the map. This bug was detected recently and a fix was implemented using @app.callback(Output()). However, for reasons not yet established, when the map was being updated, its canvas was resized to 400px by 300px, regardless of the size of the actual plot area. This resulted in a very poor user experience that could only be solved by reloading the page.

This bug could not be fixed in time but it will be addressed in the future. A decision was made to remove the live update feature in order to improve user experience with the trade off of not having a live update feature. 

_Scenario 2 - Invalid Address_
1. Navigate to [Mass Shootings US](https://mass-shootings-us.herokuapp.com/).
2. Select a date from the date picker. 
3. Enter the following:
  - Address: Alameda Yaya 25
  - Injured: 10
  - Killed: 5
4. Click on the "Save" button. 

Expected:
1. The address is not in the United States, so the app rejects the input and warns the user the address must be a valid Google Maps address in the U.S.. 
2. The alert box is displayed after the button for 4 seconds with the message "Address must be in the United States.". 

Actual: the app behaves as expected with no warnings or erros displayed in the console. 

_Scenario 3 - Missing Injured or Killed_
1. Navigate to [Mass Shootings US](https://mass-shootings-us.herokuapp.com/).
2. Click on the "List" link. 
2. Select a date from the date picker.
3. Enter the following:
  - Address: Madison Square Garden
3. Click on the "Save" button.

Expected: 
1. The incident is not recorded.
2. The alert box is displayed for 4 seconds with the message "Injured and Killed are required and must be integers.". 

Actual: The app behaves as expected. There are no warnings or erros displayed in the console. 

_Scenario 4 - Value out of range_
1. Navigate to [Mass Shootings US](https://mass-shootings-us.herokuapp.com/).
2. Click on the "List" link. 
2. Select a date from the date picker.
3. Enter the following:
  - Address: Madison Square Garden
  - Injured: -1
  - Killed: 3
3. Click on the "Save" button.

Expected: 
1. The incident is not recorded.
2. The alert box is displayed for 4 seconds with the message "Injured and Killed are required and must be non-negative integers.". 

Actual: The app behaves as expected. There are no warnings or erros displayed in the console. 

_Scenario 5 - Delete list item_
1. Navigate to [Mass Shootings US](https://mass-shootings-us.herokuapp.com/).
2. Click on the "List" link.
3. Click on the "X" button in one of the rows on the list.

Expected:
1. The incident should be removed from the list.
   
Actual: the app behaves as expected. There are no warnings or erros displayed in the console.

### Validator Testing

- Python code validation was performed by [CI Python Linter](https://pep8ci.herokuapp.com/#)

 ![Python Validation](https://alexandrearantes1.github.io/mass-shootings/assets/images/python_validation.png)


- HTML
  - No errors found when passing through the official [W3C Validator](https://validator.w3.org/).
  - One warning was issued for the "inputmode" attribute which is not supported by all browsers. This attribute was included to force mobile devices to display the numeric keypad when the Value text field is selected.
 ![W3C Validator](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/w3c-validator-index.png)

- CSS
  - No errors found when passing through the [Jigsaw Validator](https://jigsaw.w3.org/).
    - style.css:
    ![Jigsaw style.css](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/jigsaw-style.png)
    - toggle.css
    ![Jigsaw toggle.css](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/jigsaw-toggle.png)
    - tooltip.css
    ![Jigsaw tooltip.css](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/jigsaw-tooltip.png)
 
- Javascript
  - No warning or erros were found using the [JSHint Validator](https://jshint.com/) when you select the new ES6 features in the configurations. 
    - app-controller.js
    ![JSHint Validator](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/jshint-app-controller.png)
    - budget.js
    ![JSHint Validator](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/jshint-budget.png)
    - transaction.js
    ![JSHint Validator](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/jshint-transaction.png)
    - utils.js
    ![JSHint Validator](https://alexandrearantes1.github.io/budget-planner/assets/images/readme/jshint-utils.png)

### Bugs Fixed
- When clicking on the button to delete a transaction, there was a problem identifying which element was actually triggering the click event. This led to the app not finding the element which actually had the ID to be removed. 
  The solution was to check which type of element was being clicked (```<img>``` or ```<a>```) and depending on the result, seek the immediate parent element or the parent of the parent element to retrieve the ID.
  
- There was a serious issue when using the app in very small screens 320x480. The list became completely covered by footer and the layout was not apropriate for the size.
  The solution was to reduce the size of the footer icon and paddings, but it still was not enough so I decided to  
  "unstick" the form, freeing up more space at the expense of not having the form always available.  

### Unfixed Bugs
- If percentages have more than 4 digits before the decimal place, the space designated for the percentage box starts to blow up and can generate odd layout issues. It is unlikely to occur on a realistic scenario, but this issue will be addressed in a future release.

## Deployment

### Version Control

The web app was created using Virtual Studio Code IDE and pushed to the remote repository 'budget-planner'. 

The following git commands were used throughout the development of the app:

```git add <file>``` - This command was used to add the files to the staging area before they are committed.

```git commit -m "commit message"``` - This command was used to commit changes to the local repository. 

```git push``` - This command was used to push the commits to the remote repository on GitHub. 

```git pull``` - This command was used to update local files before pushing new commits, which was necessary because I was editing the README.md file directly on GitHub website. 

### Deployment to GitHub Pages
  - The site was deployed to GitHub Pages using the steps as follows:
    - In the GitHub repository, navigate to the Settings tab.
    - From the menu on left select 'Pages'.
    - From the source section drop-down menu, select the Branch: main.
    - Click 'Save'.
    - A live link will be displayed in a green banner when published successfully.
  - The live web app can be found here: [Budget Planner](https://alexandrearantes1.github.io/budget-planner/)

### Clone the Repository Code Locally
1. Navigate to the [Budget Planner Repository](https://github.com/alexandrearantes1/budget-planner).
2. Click on the code drop down button
3. Click on HTTPS
4. Copy the repository link to the clipboard
5. Open your IDE of choice (git must be installed for the next steps)
6. Type git clone copied-git-url into the IDE terminal
7. The project will now of been cloned on your local machine for use.


## Credits

- The Budget Planner was inspired by the Budgety Project from the Javascript course at [Coding Heroes](https://codingheroes.io) by Jonas Schmedtmann. 

- Header [Background Image](https://unsplash.com/photos/Vs6ip7fsld8) by Photo by [Aaron Lefler](https://unsplash.com/@alefler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)
  
- Input Numeric Keypad for Values Text Field:
  - Solution proposed by Aaron Gray [here - StackOverflow](https://stackoverflow.com/questions/6178556/phone-numeric-keyboard-for-text-input).
  
- Logo Design was done using [FreeLogoDesign](https://www.freelogodesign.org/).
  
- Tooltip CSS Only by [Reinhard Schnetzinger](https://codepen.io/reiinii1/pen/aPGXEa).

- Toggle Button (Income / Expense) based on [Gareth McKinley's toggle button](https://codepen.io/garetmckinley/pen/YmxYZr)

- Delete Button Icon from [IconScout](https://iconscout.com/icons/trash).
  
- ```formatNumber()``` function uses the regular expression solution proposed by [Scaramouche](https://stackoverflow.com/questions/49261076/applying-currency-format-using-replace-and-a-regular-expression)
to insert ',' every 3 digits and '.' before the decimal if needed.


# Credits

Regular Expressions built using [Regex builder](https://pythex.org/)

Regex to match last two words in a sentence - by StackOverflow user [harrymc](https://superuser.com/questions/1518208/regex-match-the-last-4-words-from-any-sentence-lines)

[How to efficiently apply tuple to multiple columns in a pandas dataframe simultaneously](https://stackoverflow.com/questions/44269926/how-to-efficiently-apply-tuple-to-multiple-columns-in-a-pandas-dataframe-simulta)

[Meet Plotly Mapbox. Best Choice for Geographic Data Visualization](https://towardsdatascience.com/meet-plotly-mapbox-best-choice-for-geographic-data-visualization-599b514bcd9a)

Change dataset from wiki scrape to Gun Violence Archive
Change source from wiki scrape to kaggle dataset